<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#059669">
    <title>Ù†Ú¯ÛŒÙ† Ø§Ù„ÙˆÙ†Ø¯ - Ø³ÛŒØ³ØªÙ… Ø­Ø³Ø§Ø¨Ø¯Ø§Ø±ÛŒ ØªÙˆÙ„ÛŒØ¯ Ù‚Ø§Ø±Ú†</title>
    <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoi2YbYr9uM2YYg2KfZhNmI2YbYryIsInNob3J0X25hbWUiOiLZhtqv2YrZhiDYp9mE2YjZhtivIiwic3RhcnRfdXJsIjoiLiIsImRpc3BsYXkiOiJzdGFuZGFsb25lIiwiYmFja2dyb3VuZF9jb2xvciI6IiMwNTk2NjkiLCJ0aGVtZV9jb2xvciI6IiMwNTk2NjkiLCJpY29ucyI6W3sic3JjIjoiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCM2FXUjBhRDBpTWpRaUlHaGxhV2RvZEQwaU1qUWlJSFpwWlhkQ2IzZzlJakFnTUNBeU5DQXlOQ0lnWm1sc2JEMGlJek0yWkRNNU9TSStQSEJoZEdnaVpEMGlUVEV5SURKRE9DNDFJRElnTmlBMExqVWdOaUE0WXpBZ01pNDFJREV1TlNBMExqVWdNeTQxSURVdU5YWTJZekFnTVM0eExqa2dNaTA1SURJdE1TQXhMakV0TWkwdU9TMHlMVEV6ZGpZdE5pNDFJRE10TXk0MUxUTXVOUzAxTGpWRE1UUXVOU0F4TUNBeE1pQTNMalVnTVRJZ05YcHRNQ0F5WXpJdU5TQXdJRFFnTWkwdU5TQTBMVFJUTVRVdU5TQTJJREUwSURndE1TNDFJRFF0TkNBeUxUUXRNaTQxSURFdU5TMDBJRFF0TkNBMGVpSXZQand2YzNablBnPT0iLCJzaXplcyI6IjE5MngxOTIiLCJ0eXBlIjoiaW1hZ2Uvc3ZnK3htbCJ9XX0=">
    <link rel="icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iIzM2ZDM5OSI+PHBhdGggZD0iTTEyIDJDOC41IDIgNiA0LjUgNiA4YzAgMi41IDEuNSA0LjUgMy41IDUuNXY2YzAgMS4xLjkgMiAyIDJoMWMxLjEgMCAyLS45IDItMnYtNmMyLTEgMy41LTMgMy41LTUuNSAwLTMuNS0yLjUtNi02LTZ6bTAgMmMyLjUgMCA0IDIgNCA0cy0xLjUgMy00IDMtNC0xLjUtNC0zIDEuNS00IDQtNHoiLz48L3N2Zz4=">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'vazir': ['Vazir', 'Tahoma', 'Arial', 'sans-serif']
                    },
                    colors: {
                        'emerald': {
                            50: '#ecfdf5',
                            100: '#d1fae5',
                            200: '#a7f3d0',
                            300: '#6ee7b7',
                            400: '#34d399',
                            500: '#10b981',
                            600: '#059669',
                            700: '#047857',
                            800: '#065f46',
                            900: '#064e3b'
                        }
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Vazir:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { 
            font-family: 'Vazir', Tahoma, Arial, sans-serif; 
            -webkit-tap-highlight-color: transparent;
        }
        body {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 25%, #334155 50%, #475569 75%, #64748b 100%);
            min-height: 100vh;
        }
        .gradient-header { 
            background: linear-gradient(135deg, #059669 0%, #047857 50%, #065f46 100%); 
            box-shadow: 0 10px 30px rgba(5, 150, 105, 0.3);
        }
        .card-shadow { 
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
        }
        .btn-hover:hover { 
            transform: translateY(-3px); 
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
        }
        .btn-hover:active {
            transform: translateY(-1px);
        }
        .mushroom-pattern { 
            background-image: 
                radial-gradient(circle at 25% 25%, rgba(255,255,255,0.1) 2px, transparent 2px),
                radial-gradient(circle at 75% 75%, rgba(255,255,255,0.05) 1px, transparent 1px);
            background-size: 50px 50px;
        }
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .tab-btn.active {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
        }
        .mobile-optimized {
            touch-action: manipulation;
            -webkit-user-select: none;
            user-select: none;
        }
        .input-focus:focus {
            border-color: #10b981;
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
            outline: none;
        }
        .status-active { background: linear-gradient(135deg, #10b981, #059669); }
        .status-maintenance { background: linear-gradient(135deg, #f59e0b, #d97706); }
        .status-inactive { background: linear-gradient(135deg, #ef4444, #dc2626); }
        
        @media (max-width: 768px) {
            .mobile-text { font-size: 0.875rem; }
            .mobile-padding { padding: 1rem; }
            .mobile-grid { grid-template-columns: 1fr; }
            
            /* Mobile-specific improvements */
            body { padding-bottom: 80px; }
            .container { padding-left: 0.75rem; padding-right: 0.75rem; }
            
            /* Better touch targets */
            button, input, select, textarea {
                min-height: 44px;
                font-size: 16px; /* Prevents zoom on iOS */
            }
            
            /* Mobile header */
            header .flex { flex-wrap: wrap; }
            header h1 { font-size: 1.25rem; }
            header p { font-size: 0.75rem; }
            
            /* Mobile tabs */
            .tab-btn { 
                padding: 0.75rem 1rem;
                font-size: 0.75rem;
                min-width: 80px;
            }
            
            /* Mobile forms */
            .grid { gap: 1rem; }
            .grid.grid-cols-2 { grid-template-columns: 1fr; }
            .grid.grid-cols-3 { grid-template-columns: 1fr; }
            .grid.grid-cols-4 { grid-template-columns: 1fr; }
            
            /* Mobile tables */
            table { font-size: 0.75rem; }
            th, td { padding: 0.5rem; }
            
            /* Mobile cards */
            .card-shadow { margin-bottom: 1rem; }
            
            /* Hide less important columns on mobile */
            .mobile-hide { display: none; }
        }
        
        /* PWA styles */
        .install-prompt {
            position: fixed;
            bottom: 20px;
            left: 20px;
            right: 20px;
            background: linear-gradient(135deg, #059669, #047857);
            color: white;
            padding: 1rem;
            border-radius: 1rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            z-index: 1000;
            display: none;
        }
        
        /* Offline indicator */
        .offline-indicator {
            position: fixed;
            top: 70px;
            left: 50%;
            transform: translateX(-50%);
            background: #ef4444;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            z-index: 1000;
            display: none;
        }
    </style>
</head>
<body class="font-vazir mobile-optimized">
    <!-- PWA Install Prompt -->
    <div id="installPrompt" class="install-prompt">
        <div class="flex items-center justify-between">
            <div>
                <h3 class="font-bold text-sm">Ù†ØµØ¨ Ø¨Ø±Ù†Ø§Ù…Ù‡ Ù†Ú¯ÛŒÙ† Ø§Ù„ÙˆÙ†Ø¯</h3>
                <p class="text-xs opacity-90">Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¢Ø³Ø§Ù†â€ŒØªØ±ØŒ Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø±Ø§ Ù†ØµØ¨ Ú©Ù†ÛŒØ¯</p>
            </div>
            <div class="flex space-x-2 space-x-reverse">
                <button onclick="installApp()" class="bg-white text-emerald-600 px-3 py-1 rounded-lg text-xs font-bold">
                    Ù†ØµØ¨
                </button>
                <button onclick="dismissInstall()" class="text-white opacity-75 text-xs">
                    Ø¨Ø¹Ø¯Ø§Ù‹
                </button>
            </div>
        </div>
    </div>

    <!-- Offline Indicator -->
    <div id="offlineIndicator" class="offline-indicator">
        ğŸ“¡ Ø­Ø§Ù„Øª Ø¢ÙÙ„Ø§ÛŒÙ† - Ø§ØªØµØ§Ù„ Ø§ÛŒÙ†ØªØ±Ù†Øª Ù‚Ø·Ø¹ Ø§Ø³Øª
    </div>
    <!-- Header -->
    <header class="gradient-header text-white shadow-2xl mushroom-pattern sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4 space-x-reverse">
                    <div class="bg-white bg-opacity-20 p-3 rounded-2xl">
                        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2C8.5 2 6 4.5 6 8c0 2.5 1.5 4.5 3.5 5.5v6c0 1.1.9 2 2 2h1c1.1 0 2-.9 2-2v-6c2-1 3.5-3 3.5-5.5 0-3.5-2.5-6-6-6zm0 2c2.5 0 4 2 4 4s-1.5 3-4 3-4-1.5-4-3 1.5-4 4-4z"/>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold">ğŸ„ Ù†Ú¯ÛŒÙ† Ø§Ù„ÙˆÙ†Ø¯</h1>
                        <p class="text-sm opacity-90">Ø³ÛŒØ³ØªÙ… Ø¬Ø§Ù…Ø¹ Ø­Ø³Ø§Ø¨Ø¯Ø§Ø±ÛŒ ØªÙˆÙ„ÛŒØ¯ Ù‚Ø§Ø±Ú†</p>
                    </div>
                </div>
                <div class="flex items-center space-x-3 space-x-reverse">
                    <div class="text-xs bg-white bg-opacity-20 px-3 py-2 rounded-xl">
                        ğŸ“… <span id="currentDate"></span>
                    </div>
                    <button class="bg-white bg-opacity-20 px-4 py-2 rounded-xl hover:bg-opacity-30 transition-all text-sm">
                        Ø®Ø±ÙˆØ¬
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Dashboard Cards -->
    <div class="container mx-auto px-4 py-6">
        <div class="grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
            <div class="glass-effect p-4 rounded-2xl card-shadow border-r-4 border-emerald-500">
                <div class="text-center">
                    <div class="bg-emerald-100 p-3 rounded-full w-12 h-12 mx-auto mb-3 flex items-center justify-center">
                        <svg class="w-6 h-6 text-emerald-600" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2C8.5 2 6 4.5 6 8c0 2.5 1.5 4.5 3.5 5.5v6c0 1.1.9 2 2 2h1c1.1 0 2-.9 2-2v-6c2-1 3.5-3 3.5-5.5 0-3.5-2.5-6-6-6z"/>
                        </svg>
                    </div>
                    <p class="text-gray-600 text-xs mb-1">ØªÙˆÙ„ÛŒØ¯ Ø§Ù…Ø±ÙˆØ²</p>
                    <p class="text-lg font-bold text-emerald-600" id="todayProduction">0 Ú©ÛŒÙ„Ùˆ</p>
                </div>
            </div>

            <div class="glass-effect p-4 rounded-2xl card-shadow border-r-4 border-blue-500">
                <div class="text-center">
                    <div class="bg-blue-100 p-3 rounded-full w-12 h-12 mx-auto mb-3 flex items-center justify-center">
                        <svg class="w-6 h-6 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"/>
                        </svg>
                    </div>
                    <p class="text-gray-600 text-xs mb-1">Ø¯Ø±Ø¢Ù…Ø¯ Ù…Ø§Ù‡</p>
                    <p class="text-lg font-bold text-blue-600" id="monthlyRevenue">0 ØªÙˆÙ…Ø§Ù†</p>
                </div>
            </div>

            <div class="glass-effect p-4 rounded-2xl card-shadow border-r-4 border-orange-500">
                <div class="text-center">
                    <div class="bg-orange-100 p-3 rounded-full w-12 h-12 mx-auto mb-3 flex items-center justify-center">
                        <svg class="w-6 h-6 text-orange-600" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 14H7v-2h5v2zm5-4H7v-2h10v2zm0-4H7V7h10v2z"/>
                        </svg>
                    </div>
                    <p class="text-gray-600 text-xs mb-1">Ø³Ø§Ù„Ù† ÙØ¹Ø§Ù„</p>
                    <p class="text-lg font-bold text-orange-600" id="activeHalls">0</p>
                </div>
            </div>

            <div class="glass-effect p-4 rounded-2xl card-shadow border-r-4 border-purple-500">
                <div class="text-center">
                    <div class="bg-purple-100 p-3 rounded-full w-12 h-12 mx-auto mb-3 flex items-center justify-center">
                        <svg class="w-6 h-6 text-purple-600" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z"/>
                        </svg>
                    </div>
                    <p class="text-gray-600 text-xs mb-1">Ø³ÙˆØ¯ Ø®Ø§Ù„Øµ</p>
                    <p class="text-lg font-bold text-purple-600" id="netProfit">0 ØªÙˆÙ…Ø§Ù†</p>
                </div>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <div class="glass-effect rounded-2xl card-shadow mb-6 overflow-hidden">
            <div class="flex overflow-x-auto scrollbar-hide">
                <button class="tab-btn active px-4 py-3 font-medium text-sm whitespace-nowrap transition-all duration-300 rounded-t-2xl" onclick="showTab('production')">
                    ğŸ„ Ø«Ø¨Øª ØªÙˆÙ„ÛŒØ¯
                </button>
                <button class="tab-btn px-4 py-3 font-medium text-gray-600 hover:text-emerald-600 text-sm whitespace-nowrap transition-all duration-300" onclick="showTab('halls')">
                    ğŸ¢ Ø³Ø§Ù„Ù†â€ŒÙ‡Ø§
                </button>
                <button class="tab-btn px-4 py-3 font-medium text-gray-600 hover:text-emerald-600 text-sm whitespace-nowrap transition-all duration-300" onclick="showTab('purchases')">
                    ğŸ›’ Ø«Ø¨Øª Ø®Ø±ÛŒØ¯
                </button>
                <button class="tab-btn px-4 py-3 font-medium text-gray-600 hover:text-emerald-600 text-sm whitespace-nowrap transition-all duration-300" onclick="showTab('sales')">
                    ğŸ’° Ø«Ø¨Øª ÙØ±ÙˆØ´
                </button>
                <button class="tab-btn px-4 py-3 font-medium text-gray-600 hover:text-emerald-600 text-sm whitespace-nowrap transition-all duration-300" onclick="showTab('expenses')">
                    ğŸ’¸ Ø«Ø¨Øª Ù‡Ø²ÛŒÙ†Ù‡
                </button>
                <button class="tab-btn px-4 py-3 font-medium text-gray-600 hover:text-emerald-600 text-sm whitespace-nowrap transition-all duration-300" onclick="showTab('reports')">
                    ğŸ“Š Ú¯Ø²Ø§Ø±Ø´Ø§Øª
                </button>
                <button class="tab-btn px-4 py-3 font-medium text-gray-600 hover:text-emerald-600 text-sm whitespace-nowrap transition-all duration-300" onclick="showTab('profitloss')">
                    ğŸ“ˆ Ø³ÙˆØ¯ Ùˆ Ø²ÛŒØ§Ù†
                </button>
            </div>

            <!-- Production Tab -->
            <div id="production" class="tab-content p-4">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-lg font-bold text-gray-800">ğŸ„ Ø«Ø¨Øª ØªÙˆÙ„ÛŒØ¯ Ùˆ Ø¨Ø±Ø¯Ø§Ø´Øª</h2>
                    <button onclick="showAddProduction()" class="bg-gradient-to-r from-emerald-500 to-emerald-600 text-white px-4 py-2 rounded-xl btn-hover text-sm">
                        + Ø«Ø¨Øª ØªÙˆÙ„ÛŒØ¯
                    </button>
                </div>

                <!-- Add Production Form -->
                <div id="addProductionForm" class="hidden glass-effect p-4 rounded-xl mb-4">
                    <h3 class="text-md font-semibold mb-4 text-gray-800">Ø«Ø¨Øª ØªÙˆÙ„ÛŒØ¯ Ø¬Ø¯ÛŒØ¯</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ø´Ù…Ø§Ø±Ù‡/Ù†Ø§Ù… Ø³Ø§Ù„Ù†</label>
                            <select id="productionHall" class="w-full p-3 border rounded-xl input-focus bg-white">
                                <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ø³Ø§Ù„Ù†</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">ØªØ§Ø±ÛŒØ® Ø¨Ø±Ø¯Ø§Ø´Øª</label>
                            <input type="date" id="harvestDate" class="w-full p-3 border rounded-xl input-focus">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">ÙˆØ²Ù† Ø¨Ø±Ø¯Ø§Ø´Øª (Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…)</label>
                            <input type="number" step="0.1" id="harvestWeight" class="w-full p-3 border rounded-xl input-focus" placeholder="ÙˆØ²Ù† Ù‚Ø§Ø±Ú† Ø¨Ø±Ø¯Ø§Ø´Øª Ø´Ø¯Ù‡">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ú©ÛŒÙÛŒØª Ù…Ø­ØµÙˆÙ„</label>
                            <select id="productQuality" class="w-full p-3 border rounded-xl input-focus">
                                <option value="A">Ø¯Ø±Ø¬Ù‡ ÛŒÚ© (A) - Ø¹Ø§Ù„ÛŒ</option>
                                <option value="B">Ø¯Ø±Ø¬Ù‡ Ø¯Ùˆ (B) - Ø®ÙˆØ¨</option>
                                <option value="C">Ø¯Ø±Ø¬Ù‡ Ø³Ù‡ (C) - Ù…ØªÙˆØ³Ø·</option>
                                <option value="D">Ø¯Ø±Ø¬Ù‡ Ú†Ù‡Ø§Ø± (D) - Ø¶Ø§ÛŒØ¹Ø§Øª</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ù…Ù‚Ø¯Ø§Ø± Ú©Ù…Ù¾ÙˆØ³Øª Ù…ØµØ±ÙÛŒ (Ú©ÛŒÙ„Ùˆ)</label>
                            <input type="number" step="0.1" id="compostUsed" class="w-full p-3 border rounded-xl input-focus" placeholder="Ú©Ù…Ù¾ÙˆØ³Øª Ù…ØµØ±Ù Ø´Ø¯Ù‡">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">ØªØ¹Ø¯Ø§Ø¯ Ù‚Ø§Ø±Ú† Ø¨Ø±Ø¯Ø§Ø´Øª Ø´Ø¯Ù‡</label>
                            <input type="number" id="mushroomCount" class="w-full p-3 border rounded-xl input-focus" placeholder="ØªØ¹Ø¯Ø§Ø¯ Ù‚Ø§Ø±Ú†">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ø¯Ù…Ø§ÛŒ Ø³Ø§Ù„Ù† (Â°C)</label>
                            <input type="number" step="0.1" id="hallTemp" class="w-full p-3 border rounded-xl input-focus" placeholder="Ø¯Ù…Ø§ÛŒ Ø³Ø§Ù„Ù†">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ø±Ø·ÙˆØ¨Øª (%)</label>
                            <input type="number" step="0.1" id="hallHumidity" class="w-full p-3 border rounded-xl input-focus" placeholder="Ø¯Ø±ØµØ¯ Ø±Ø·ÙˆØ¨Øª">
                        </div>
                    </div>
                    <div class="mt-4">
                        <label class="block text-sm font-medium mb-2 text-gray-700">ÛŒØ§Ø¯Ø¯Ø§Ø´Øª</label>
                        <textarea id="productionNotes" class="w-full p-3 border rounded-xl input-focus" rows="3" placeholder="ÛŒØ§Ø¯Ø¯Ø§Ø´Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ø¨Ø±Ø¯Ø§Ø´Øª"></textarea>
                    </div>
                    <div class="flex space-x-3 space-x-reverse mt-4">
                        <button onclick="addProduction()" class="bg-gradient-to-r from-emerald-500 to-emerald-600 text-white px-6 py-2 rounded-xl btn-hover">
                            Ø«Ø¨Øª ØªÙˆÙ„ÛŒØ¯
                        </button>
                        <button onclick="hideAddProduction()" class="bg-gradient-to-r from-gray-500 to-gray-600 text-white px-6 py-2 rounded-xl btn-hover">
                            Ø§Ù†ØµØ±Ø§Ù
                        </button>
                    </div>
                </div>

                <!-- Production List -->
                <div class="glass-effect rounded-xl overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gradient-to-r from-emerald-500 to-emerald-600 text-white">
                                <tr>
                                    <th class="p-3 text-right text-sm">ØªØ§Ø±ÛŒØ®</th>
                                    <th class="p-3 text-right text-sm">Ø³Ø§Ù„Ù†</th>
                                    <th class="p-3 text-right text-sm">ÙˆØ²Ù† (Ú©ÛŒÙ„Ùˆ)</th>
                                    <th class="p-3 text-right text-sm mobile-hide">Ú©ÛŒÙÛŒØª</th>
                                    <th class="p-3 text-right text-sm mobile-hide">Ú©Ù…Ù¾ÙˆØ³Øª</th>
                                    <th class="p-3 text-right text-sm">Ø±Ø§Ù†Ø¯Ù…Ø§Ù†</th>
                                    <th class="p-3 text-right text-sm">Ø¹Ù…Ù„ÛŒØ§Øª</th>
                                </tr>
                            </thead>
                            <tbody id="productionList" class="bg-white">
                                <tr>
                                    <td colspan="7" class="p-8 text-center text-gray-500">
                                        Ù‡ÛŒÚ† ØªÙˆÙ„ÛŒØ¯ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Halls Management Tab -->
            <div id="halls" class="tab-content hidden p-4">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-lg font-bold text-gray-800">ğŸ¢ Ù…Ø¯ÛŒØ±ÛŒØª Ø³Ø§Ù„Ù†â€ŒÙ‡Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯</h2>
                    <button onclick="showAddHall()" class="bg-gradient-to-r from-emerald-500 to-emerald-600 text-white px-4 py-2 rounded-xl btn-hover text-sm">
                        + Ø§ÙØ²ÙˆØ¯Ù† Ø³Ø§Ù„Ù†
                    </button>
                </div>

                <!-- Add Hall Form -->
                <div id="addHallForm" class="hidden glass-effect p-4 rounded-xl mb-4">
                    <h3 class="text-md font-semibold mb-4 text-gray-800">Ø§ÙØ²ÙˆØ¯Ù† Ø³Ø§Ù„Ù† Ø¬Ø¯ÛŒØ¯</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ø´Ù…Ø§Ø±Ù‡ Ø³Ø§Ù„Ù†</label>
                            <input type="text" id="hallNumber" class="w-full p-3 border rounded-xl input-focus" placeholder="Ø´Ù…Ø§Ø±Ù‡ Ø³Ø§Ù„Ù† (Ù…Ø«Ø§Ù„: S001)">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ù†Ø§Ù… Ø³Ø§Ù„Ù†</label>
                            <input type="text" id="hallName" class="w-full p-3 border rounded-xl input-focus" placeholder="Ù†Ø§Ù… Ø³Ø§Ù„Ù†">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ù…Ø³Ø§Ø­Øª (Ù…ØªØ± Ù…Ø±Ø¨Ø¹)</label>
                            <input type="number" id="hallArea" class="w-full p-3 border rounded-xl input-focus" placeholder="Ù…Ø³Ø§Ø­Øª">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ø¸Ø±ÙÛŒØª ØªÙˆÙ„ÛŒØ¯ (Ú©ÛŒÙ„Ùˆ/Ù…Ø§Ù‡)</label>
                            <input type="number" id="hallCapacity" class="w-full p-3 border rounded-xl input-focus" placeholder="Ø¸Ø±ÙÛŒØª ØªÙˆÙ„ÛŒØ¯">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">ØªØ§Ø±ÛŒØ® Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ</label>
                            <input type="date" id="hallStartDate" class="w-full p-3 border rounded-xl input-focus">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">ÙˆØ¶Ø¹ÛŒØª</label>
                            <select id="hallStatus" class="w-full p-3 border rounded-xl input-focus">
                                <option value="active">ÙØ¹Ø§Ù„</option>
                                <option value="maintenance">ØªØ¹Ù…ÛŒØ±Ø§Øª</option>
                                <option value="inactive">ØºÛŒØ±ÙØ¹Ø§Ù„</option>
                            </select>
                        </div>
                    </div>
                    <div class="flex space-x-3 space-x-reverse mt-4">
                        <button onclick="addHall()" class="bg-gradient-to-r from-emerald-500 to-emerald-600 text-white px-6 py-2 rounded-xl btn-hover">
                            Ø«Ø¨Øª Ø³Ø§Ù„Ù†
                        </button>
                        <button onclick="hideAddHall()" class="bg-gradient-to-r from-gray-500 to-gray-600 text-white px-6 py-2 rounded-xl btn-hover">
                            Ø§Ù†ØµØ±Ø§Ù
                        </button>
                    </div>
                </div>

                <!-- Halls Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" id="hallsList">
                    <div class="glass-effect p-4 rounded-xl text-center">
                        <p class="text-gray-500">Ù‡ÛŒÚ† Ø³Ø§Ù„Ù†ÛŒ ØªØ¹Ø±ÛŒÙ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª</p>
                    </div>
                </div>
            </div>

            <!-- Purchases Tab -->
            <div id="purchases" class="tab-content hidden p-4">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-lg font-bold text-gray-800">ğŸ›’ Ø«Ø¨Øª Ø®Ø±ÛŒØ¯ Ù…ÙˆØ§Ø¯ Ø§ÙˆÙ„ÛŒÙ‡</h2>
                    <button onclick="showAddPurchase()" class="bg-gradient-to-r from-blue-500 to-blue-600 text-white px-4 py-2 rounded-xl btn-hover text-sm">
                        + Ø«Ø¨Øª Ø®Ø±ÛŒØ¯
                    </button>
                </div>

                <!-- Add Purchase Form -->
                <div id="addPurchaseForm" class="hidden glass-effect p-4 rounded-xl mb-4">
                    <h3 class="text-md font-semibold mb-4 text-gray-800">Ø«Ø¨Øª Ø®Ø±ÛŒØ¯ Ø¬Ø¯ÛŒØ¯</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ù†Ø§Ù… Ú©Ø§Ù„Ø§/Ù…Ø§Ø¯Ù‡</label>
                            <input type="text" id="purchaseItem" class="w-full p-3 border rounded-xl input-focus" placeholder="Ù†Ø§Ù… Ú©Ø§Ù„Ø§ ÛŒØ§ Ù…Ø§Ø¯Ù‡ Ø§ÙˆÙ„ÛŒÙ‡">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ù†Ø§Ù… ÙØ±ÙˆØ´Ù†Ø¯Ù‡</label>
                            <input type="text" id="supplierName" class="w-full p-3 border rounded-xl input-focus" placeholder="Ù†Ø§Ù… ÙØ±ÙˆØ´Ù†Ø¯Ù‡">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">ØªØ§Ø±ÛŒØ® Ø®Ø±ÛŒØ¯</label>
                            <input type="date" id="purchaseDate" class="w-full p-3 border rounded-xl input-focus">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ù…Ù‚Ø¯Ø§Ø±</label>
                            <input type="number" step="0.1" id="purchaseQuantity" class="w-full p-3 border rounded-xl input-focus" placeholder="Ù…Ù‚Ø¯Ø§Ø± Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒ Ø´Ø¯Ù‡">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">ÙˆØ§Ø­Ø¯</label>
                            <select id="purchaseUnit" class="w-full p-3 border rounded-xl input-focus">
                                <option value="kg">Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…</option>
                                <option value="ton">ØªÙ†</option>
                                <option value="liter">Ù„ÛŒØªØ±</option>
                                <option value="piece">Ø¹Ø¯Ø¯</option>
                                <option value="bag">Ú©ÛŒØ³Ù‡</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ù‚ÛŒÙ…Øª ÙˆØ§Ø­Ø¯ (ØªÙˆÙ…Ø§Ù†)</label>
                            <input type="number" id="purchaseUnitPrice" class="w-full p-3 border rounded-xl input-focus" placeholder="Ù‚ÛŒÙ…Øª Ù‡Ø± ÙˆØ§Ø­Ø¯">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ù…Ø¨Ù„Øº Ú©Ù„ (ØªÙˆÙ…Ø§Ù†)</label>
                            <input type="number" id="purchaseTotalAmount" class="w-full p-3 border rounded-xl input-focus" placeholder="Ù…Ø¨Ù„Øº Ú©Ù„" readonly>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ù†ÙˆØ¹ Ù¾Ø±Ø¯Ø§Ø®Øª</label>
                            <select id="purchasePaymentType" class="w-full p-3 border rounded-xl input-focus">
                                <option value="cash">Ù†Ù‚Ø¯ÛŒ</option>
                                <option value="credit">Ø§Ø¹ØªØ¨Ø§Ø±ÛŒ</option>
                                <option value="check">Ú†Ú©</option>
                                <option value="transfer">Ø­ÙˆØ§Ù„Ù‡</option>
                            </select>
                        </div>
                    </div>
                    <div class="mt-4">
                        <label class="block text-sm font-medium mb-2 text-gray-700">ØªÙˆØ¶ÛŒØ­Ø§Øª</label>
                        <textarea id="purchaseNotes" class="w-full p-3 border rounded-xl input-focus" rows="3" placeholder="ØªÙˆØ¶ÛŒØ­Ø§Øª Ø®Ø±ÛŒØ¯"></textarea>
                    </div>
                    <div class="flex space-x-3 space-x-reverse mt-4">
                        <button onclick="addPurchase()" class="bg-gradient-to-r from-blue-500 to-blue-600 text-white px-6 py-2 rounded-xl btn-hover">
                            Ø«Ø¨Øª Ø®Ø±ÛŒØ¯
                        </button>
                        <button onclick="hideAddPurchase()" class="bg-gradient-to-r from-gray-500 to-gray-600 text-white px-6 py-2 rounded-xl btn-hover">
                            Ø§Ù†ØµØ±Ø§Ù
                        </button>
                    </div>
                </div>

                <!-- Purchases List -->
                <div class="glass-effect rounded-xl overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gradient-to-r from-blue-500 to-blue-600 text-white">
                                <tr>
                                    <th class="p-3 text-right text-sm">ØªØ§Ø±ÛŒØ®</th>
                                    <th class="p-3 text-right text-sm">Ú©Ø§Ù„Ø§</th>
                                    <th class="p-3 text-right text-sm">ÙØ±ÙˆØ´Ù†Ø¯Ù‡</th>
                                    <th class="p-3 text-right text-sm">Ù…Ù‚Ø¯Ø§Ø±</th>
                                    <th class="p-3 text-right text-sm">Ù‚ÛŒÙ…Øª ÙˆØ§Ø­Ø¯</th>
                                    <th class="p-3 text-right text-sm">Ù…Ø¨Ù„Øº Ú©Ù„</th>
                                    <th class="p-3 text-right text-sm">Ø¹Ù…Ù„ÛŒØ§Øª</th>
                                </tr>
                            </thead>
                            <tbody id="purchasesList" class="bg-white">
                                <tr>
                                    <td colspan="7" class="p-8 text-center text-gray-500">
                                        Ù‡ÛŒÚ† Ø®Ø±ÛŒØ¯ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Sales Tab -->
            <div id="sales" class="tab-content hidden p-4">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-lg font-bold text-gray-800">ğŸ’° Ø«Ø¨Øª ÙØ±ÙˆØ´ Ù…Ø­ØµÙˆÙ„Ø§Øª</h2>
                    <button onclick="showAddSale()" class="bg-gradient-to-r from-green-500 to-green-600 text-white px-4 py-2 rounded-xl btn-hover text-sm">
                        + Ø«Ø¨Øª ÙØ±ÙˆØ´
                    </button>
                </div>

                <!-- Add Sale Form -->
                <div id="addSaleForm" class="hidden glass-effect p-4 rounded-xl mb-4">
                    <h3 class="text-md font-semibold mb-4 text-gray-800">Ø«Ø¨Øª ÙØ±ÙˆØ´ Ø¬Ø¯ÛŒØ¯</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ù†Ø§Ù… Ù…Ø´ØªØ±ÛŒ</label>
                            <input type="text" id="customerName" class="w-full p-3 border rounded-xl input-focus" placeholder="Ù†Ø§Ù… Ù…Ø´ØªØ±ÛŒ">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³</label>
                            <input type="tel" id="customerPhone" class="w-full p-3 border rounded-xl input-focus" placeholder="Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">ØªØ§Ø±ÛŒØ® ÙØ±ÙˆØ´</label>
                            <input type="date" id="saleDate" class="w-full p-3 border rounded-xl input-focus">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ù†ÙˆØ¹ Ù…Ø´ØªØ±ÛŒ</label>
                            <select id="customerType" class="w-full p-3 border rounded-xl input-focus">
                                <option value="retail">Ø®Ø±Ø¯Ù‡â€ŒÙØ±ÙˆØ´ÛŒ</option>
                                <option value="wholesale">Ø¹Ù…Ø¯Ù‡â€ŒÙØ±ÙˆØ´ÛŒ</option>
                                <option value="restaurant">Ø±Ø³ØªÙˆØ±Ø§Ù†</option>
                                <option value="supermarket">Ø³ÙˆÙ¾Ø±Ù…Ø§Ø±Ú©Øª</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">ÙˆØ²Ù† ÙØ±ÙˆØ®ØªÙ‡ Ø´Ø¯Ù‡ (Ú©ÛŒÙ„Ùˆ)</label>
                            <input type="number" step="0.1" id="saleWeight" class="w-full p-3 border rounded-xl input-focus" placeholder="ÙˆØ²Ù†">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ú©ÛŒÙÛŒØª Ù…Ø­ØµÙˆÙ„</label>
                            <select id="saleQuality" class="w-full p-3 border rounded-xl input-focus">
                                <option value="A">Ø¯Ø±Ø¬Ù‡ ÛŒÚ© (A)</option>
                                <option value="B">Ø¯Ø±Ø¬Ù‡ Ø¯Ùˆ (B)</option>
                                <option value="C">Ø¯Ø±Ø¬Ù‡ Ø³Ù‡ (C)</option>
                                <option value="D">Ø¯Ø±Ø¬Ù‡ Ú†Ù‡Ø§Ø± (D)</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ù‚ÛŒÙ…Øª Ù‡Ø± Ú©ÛŒÙ„Ùˆ (ØªÙˆÙ…Ø§Ù†)</label>
                            <input type="number" id="pricePerKg" class="w-full p-3 border rounded-xl input-focus" placeholder="Ù‚ÛŒÙ…Øª Ù‡Ø± Ú©ÛŒÙ„Ùˆ">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ù…Ø¨Ù„Øº Ú©Ù„ (ØªÙˆÙ…Ø§Ù†)</label>
                            <input type="number" id="saleTotalAmount" class="w-full p-3 border rounded-xl input-focus" placeholder="Ù…Ø¨Ù„Øº Ú©Ù„" readonly>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ù†ÙˆØ¹ Ù¾Ø±Ø¯Ø§Ø®Øª</label>
                            <select id="salePaymentType" class="w-full p-3 border rounded-xl input-focus">
                                <option value="cash">Ù†Ù‚Ø¯ÛŒ</option>
                                <option value="credit">Ø§Ø¹ØªØ¨Ø§Ø±ÛŒ</option>
                                <option value="check">Ú†Ú©</option>
                                <option value="transfer">Ø­ÙˆØ§Ù„Ù‡</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ù‚ÛŒÙ…Øª ØªÙ…Ø§Ù… Ø´Ø¯Ù‡ (ØªÙˆÙ…Ø§Ù†/Ú©ÛŒÙ„Ùˆ)</label>
                            <input type="number" id="costPrice" class="w-full p-3 border rounded-xl input-focus" placeholder="Ù‚ÛŒÙ…Øª ØªÙ…Ø§Ù… Ø´Ø¯Ù‡">
                        </div>
                    </div>
                    <div class="mt-4">
                        <label class="block text-sm font-medium mb-2 text-gray-700">ØªÙˆØ¶ÛŒØ­Ø§Øª</label>
                        <textarea id="saleNotes" class="w-full p-3 border rounded-xl input-focus" rows="3" placeholder="ØªÙˆØ¶ÛŒØ­Ø§Øª ÙØ±ÙˆØ´"></textarea>
                    </div>
                    <div class="flex space-x-3 space-x-reverse mt-4">
                        <button onclick="addSale()" class="bg-gradient-to-r from-green-500 to-green-600 text-white px-6 py-2 rounded-xl btn-hover">
                            Ø«Ø¨Øª ÙØ±ÙˆØ´
                        </button>
                        <button onclick="hideAddSale()" class="bg-gradient-to-r from-gray-500 to-gray-600 text-white px-6 py-2 rounded-xl btn-hover">
                            Ø§Ù†ØµØ±Ø§Ù
                        </button>
                    </div>
                </div>

                <!-- Sales List -->
                <div class="glass-effect rounded-xl overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gradient-to-r from-green-500 to-green-600 text-white">
                                <tr>
                                    <th class="p-3 text-right text-sm">ØªØ§Ø±ÛŒØ®</th>
                                    <th class="p-3 text-right text-sm">Ù…Ø´ØªØ±ÛŒ</th>
                                    <th class="p-3 text-right text-sm">ÙˆØ²Ù†</th>
                                    <th class="p-3 text-right text-sm">Ù‚ÛŒÙ…Øª/Ú©ÛŒÙ„Ùˆ</th>
                                    <th class="p-3 text-right text-sm">Ù…Ø¨Ù„Øº Ú©Ù„</th>
                                    <th class="p-3 text-right text-sm">Ø³ÙˆØ¯</th>
                                    <th class="p-3 text-right text-sm">Ø¹Ù…Ù„ÛŒØ§Øª</th>
                                </tr>
                            </thead>
                            <tbody id="salesList" class="bg-white">
                                <tr>
                                    <td colspan="7" class="p-8 text-center text-gray-500">
                                        Ù‡ÛŒÚ† ÙØ±ÙˆØ´ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Expenses Tab -->
            <div id="expenses" class="tab-content hidden p-4">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-lg font-bold text-gray-800">ğŸ’¸ Ø«Ø¨Øª Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§</h2>
                    <button onclick="showAddExpense()" class="bg-gradient-to-r from-red-500 to-red-600 text-white px-4 py-2 rounded-xl btn-hover text-sm">
                        + Ø«Ø¨Øª Ù‡Ø²ÛŒÙ†Ù‡
                    </button>
                </div>

                <!-- Add Expense Form -->
                <div id="addExpenseForm" class="hidden glass-effect p-4 rounded-xl mb-4">
                    <h3 class="text-md font-semibold mb-4 text-gray-800">Ø«Ø¨Øª Ù‡Ø²ÛŒÙ†Ù‡ Ø¬Ø¯ÛŒØ¯</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ù†ÙˆØ¹ Ù‡Ø²ÛŒÙ†Ù‡</label>
                            <select id="expenseCategory" class="w-full p-3 border rounded-xl input-focus">
                                <option value="materials">Ù…ÙˆØ§Ø¯ Ø§ÙˆÙ„ÛŒÙ‡</option>
                                <option value="labor">Ù†ÛŒØ±ÙˆÛŒ Ú©Ø§Ø±</option>
                                <option value="energy">Ø§Ù†Ø±Ú˜ÛŒ (Ø¨Ø±Ù‚ØŒ Ú¯Ø§Ø²ØŒ Ø¢Ø¨)</option>
                                <option value="maintenance">ØªØ¹Ù…ÛŒØ± Ùˆ Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ</option>
                                <option value="transport">Ø­Ù…Ù„ Ùˆ Ù†Ù‚Ù„</option>
                                <option value="packaging">Ø¨Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ</option>
                                <option value="insurance">Ø¨ÛŒÙ…Ù‡</option>
                                <option value="rent">Ø§Ø¬Ø§Ø±Ù‡</option>
                                <option value="other">Ø³Ø§ÛŒØ±</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">ØªØ§Ø±ÛŒØ®</label>
                            <input type="date" id="expenseDate" class="w-full p-3 border rounded-xl input-focus">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ù…Ø¨Ù„Øº (ØªÙˆÙ…Ø§Ù†)</label>
                            <input type="number" id="expenseAmount" class="w-full p-3 border rounded-xl input-focus" placeholder="Ù…Ø¨Ù„Øº Ù‡Ø²ÛŒÙ†Ù‡">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ù¾Ø±Ø¯Ø§Ø®Øªâ€ŒÚ©Ù†Ù†Ø¯Ù‡</label>
                            <input type="text" id="paidTo" class="w-full p-3 border rounded-xl input-focus" placeholder="Ù†Ø§Ù… ÙØ±Ø¯ ÛŒØ§ Ø´Ø±Ú©Øª">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ù†ÙˆØ¹ Ù¾Ø±Ø¯Ø§Ø®Øª</label>
                            <select id="expensePaymentType" class="w-full p-3 border rounded-xl input-focus">
                                <option value="cash">Ù†Ù‚Ø¯ÛŒ</option>
                                <option value="check">Ú†Ú©</option>
                                <option value="transfer">Ø­ÙˆØ§Ù„Ù‡</option>
                                <option value="card">Ú©Ø§Ø±Øª</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ø´Ù…Ø§Ø±Ù‡ Ø³Ù†Ø¯</label>
                            <input type="text" id="expenseDocNumber" class="w-full p-3 border rounded-xl input-focus" placeholder="Ø´Ù…Ø§Ø±Ù‡ Ø³Ù†Ø¯">
                        </div>
                    </div>
                    <div class="mt-4">
                        <label class="block text-sm font-medium mb-2 text-gray-700">ØªÙˆØ¶ÛŒØ­Ø§Øª</label>
                        <textarea id="expenseDescription" class="w-full p-3 border rounded-xl input-focus" rows="3" placeholder="ØªÙˆØ¶ÛŒØ­Ø§Øª Ù‡Ø²ÛŒÙ†Ù‡"></textarea>
                    </div>
                    <div class="flex space-x-3 space-x-reverse mt-4">
                        <button onclick="addExpense()" class="bg-gradient-to-r from-red-500 to-red-600 text-white px-6 py-2 rounded-xl btn-hover">
                            Ø«Ø¨Øª Ù‡Ø²ÛŒÙ†Ù‡
                        </button>
                        <button onclick="hideAddExpense()" class="bg-gradient-to-r from-gray-500 to-gray-600 text-white px-6 py-2 rounded-xl btn-hover">
                            Ø§Ù†ØµØ±Ø§Ù
                        </button>
                    </div>
                </div>

                <!-- Expenses List -->
                <div class="glass-effect rounded-xl overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-gradient-to-r from-red-500 to-red-600 text-white">
                                <tr>
                                    <th class="p-3 text-right text-sm">ØªØ§Ø±ÛŒØ®</th>
                                    <th class="p-3 text-right text-sm">Ù†ÙˆØ¹ Ù‡Ø²ÛŒÙ†Ù‡</th>
                                    <th class="p-3 text-right text-sm">Ù…Ø¨Ù„Øº</th>
                                    <th class="p-3 text-right text-sm">Ù¾Ø±Ø¯Ø§Ø®Øª Ø¨Ù‡</th>
                                    <th class="p-3 text-right text-sm">Ù†ÙˆØ¹ Ù¾Ø±Ø¯Ø§Ø®Øª</th>
                                    <th class="p-3 text-right text-sm">Ø¹Ù…Ù„ÛŒØ§Øª</th>
                                </tr>
                            </thead>
                            <tbody id="expensesList" class="bg-white">
                                <tr>
                                    <td colspan="6" class="p-8 text-center text-gray-500">
                                        Ù‡ÛŒÚ† Ù‡Ø²ÛŒÙ†Ù‡â€ŒØ§ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Reports Tab -->
            <div id="reports" class="tab-content hidden p-4">
                <h2 class="text-lg font-bold mb-4 text-gray-800">ğŸ“Š Ú¯Ø²Ø§Ø±Ø´Ø§Øª ØªØ®ØµØµÛŒ</h2>
                
                <!-- Report Filters -->
                <div class="glass-effect p-4 rounded-xl mb-4">
                    <h3 class="text-md font-semibold mb-3 text-gray-800">ÙÛŒÙ„ØªØ±Ù‡Ø§ÛŒ Ú¯Ø²Ø§Ø±Ø´</h3>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ø§Ø² ØªØ§Ø±ÛŒØ®</label>
                            <input type="date" id="reportFromDate" class="w-full p-3 border rounded-xl input-focus">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">ØªØ§ ØªØ§Ø±ÛŒØ®</label>
                            <input type="date" id="reportToDate" class="w-full p-3 border rounded-xl input-focus">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ø³Ø§Ù„Ù†</label>
                            <select id="reportHall" class="w-full p-3 border rounded-xl input-focus">
                                <option value="">Ù‡Ù…Ù‡ Ø³Ø§Ù„Ù†â€ŒÙ‡Ø§</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ø·Ø±Ù Ø­Ø³Ø§Ø¨</label>
                            <input type="text" id="reportParty" class="w-full p-3 border rounded-xl input-focus" placeholder="Ù†Ø§Ù… Ù…Ø´ØªØ±ÛŒ ÛŒØ§ ÙØ±ÙˆØ´Ù†Ø¯Ù‡">
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
                    <div class="glass-effect p-4 rounded-xl card-shadow">
                        <h3 class="font-semibold mb-3 text-emerald-700">ğŸ„ Ú¯Ø²Ø§Ø±Ø´ ØªÙˆÙ„ÛŒØ¯</h3>
                        <p class="text-gray-600 mb-4 text-sm">ØªØ­Ù„ÛŒÙ„ ØªÙˆÙ„ÛŒØ¯ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø³Ø§Ù„Ù† Ùˆ ØªØ§Ø±ÛŒØ®</p>
                        <button onclick="generateProductionReport()" class="w-full bg-gradient-to-r from-emerald-500 to-emerald-600 text-white py-2 rounded-xl btn-hover text-sm">
                            ØªÙˆÙ„ÛŒØ¯ Ú¯Ø²Ø§Ø±Ø´
                        </button>
                    </div>

                    <div class="glass-effect p-4 rounded-xl card-shadow">
                        <h3 class="font-semibold mb-3 text-blue-700">ğŸ’° Ú¯Ø²Ø§Ø±Ø´ ÙØ±ÙˆØ´</h3>
                        <p class="text-gray-600 mb-4 text-sm">ØªØ­Ù„ÛŒÙ„ ÙØ±ÙˆØ´ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù…Ø´ØªØ±ÛŒ Ùˆ ØªØ§Ø±ÛŒØ®</p>
                        <button onclick="generateSalesReport()" class="w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white py-2 rounded-xl btn-hover text-sm">
                            ØªÙˆÙ„ÛŒØ¯ Ú¯Ø²Ø§Ø±Ø´
                        </button>
                    </div>

                    <div class="glass-effect p-4 rounded-xl card-shadow">
                        <h3 class="font-semibold mb-3 text-purple-700">ğŸ“ˆ Ú¯Ø²Ø§Ø±Ø´ Ø±Ø§Ù†Ø¯Ù…Ø§Ù† Ø³Ø§Ù„Ù†â€ŒÙ‡Ø§</h3>
                        <p class="text-gray-600 mb-4 text-sm">Ø±Ø§Ù†Ø¯Ù…Ø§Ù† Ø¨Ø± Ø§Ø³Ø§Ø³ Ú©Ù…Ù¾ÙˆØ³Øª Ùˆ ØªÙˆÙ„ÛŒØ¯</p>
                        <button onclick="generateEfficiencyReport()" class="w-full bg-gradient-to-r from-purple-500 to-purple-600 text-white py-2 rounded-xl btn-hover text-sm">
                            ØªÙˆÙ„ÛŒØ¯ Ú¯Ø²Ø§Ø±Ø´
                        </button>
                    </div>

                    <div class="glass-effect p-4 rounded-xl card-shadow">
                        <h3 class="font-semibold mb-3 text-orange-700">ğŸ›’ Ú¯Ø²Ø§Ø±Ø´ Ø®Ø±ÛŒØ¯</h3>
                        <p class="text-gray-600 mb-4 text-sm">ØªØ­Ù„ÛŒÙ„ Ø®Ø±ÛŒØ¯ Ø¨Ø± Ø§Ø³Ø§Ø³ ÙØ±ÙˆØ´Ù†Ø¯Ù‡</p>
                        <button onclick="generatePurchaseReport()" class="w-full bg-gradient-to-r from-orange-500 to-orange-600 text-white py-2 rounded-xl btn-hover text-sm">
                            ØªÙˆÙ„ÛŒØ¯ Ú¯Ø²Ø§Ø±Ø´
                        </button>
                    </div>

                    <div class="glass-effect p-4 rounded-xl card-shadow">
                        <h3 class="font-semibold mb-3 text-red-700">ğŸ’¸ Ú¯Ø²Ø§Ø±Ø´ Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§</h3>
                        <p class="text-gray-600 mb-4 text-sm">ØªØ­Ù„ÛŒÙ„ Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù†ÙˆØ¹</p>
                        <button onclick="generateExpenseReport()" class="w-full bg-gradient-to-r from-red-500 to-red-600 text-white py-2 rounded-xl btn-hover text-sm">
                            ØªÙˆÙ„ÛŒØ¯ Ú¯Ø²Ø§Ø±Ø´
                        </button>
                    </div>

                    <div class="glass-effect p-4 rounded-xl card-shadow">
                        <h3 class="font-semibold mb-3 text-indigo-700">ğŸ‘¥ Ú¯Ø²Ø§Ø±Ø´ Ø·Ø±Ù Ø­Ø³Ø§Ø¨</h3>
                        <p class="text-gray-600 mb-4 text-sm">ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ÛŒ Ù‡Ø± Ø·Ø±Ù Ø­Ø³Ø§Ø¨</p>
                        <button onclick="generatePartyReport()" class="w-full bg-gradient-to-r from-indigo-500 to-indigo-600 text-white py-2 rounded-xl btn-hover text-sm">
                            ØªÙˆÙ„ÛŒØ¯ Ú¯Ø²Ø§Ø±Ø´
                        </button>
                    </div>
                </div>

                <!-- Report Display Area -->
                <div id="reportDisplay" class="hidden glass-effect p-4 rounded-xl card-shadow">
                    <div class="flex justify-between items-center mb-4">
                        <h3 id="reportTitle" class="text-md font-semibold text-gray-800"></h3>
                        <div class="space-x-2 space-x-reverse">
                            <button onclick="printReport()" class="bg-gradient-to-r from-gray-500 to-gray-600 text-white px-4 py-2 rounded-xl btn-hover text-sm">
                                ğŸ–¨ï¸ Ú†Ø§Ù¾
                            </button>
                            <button onclick="exportReport()" class="bg-gradient-to-r from-emerald-500 to-emerald-600 text-white px-4 py-2 rounded-xl btn-hover text-sm">
                                ğŸ“Š Ø®Ø±ÙˆØ¬ÛŒ
                            </button>
                        </div>
                    </div>
                    <div id="reportContent"></div>
                </div>
            </div>

            <!-- Profit & Loss Tab -->
            <div id="profitloss" class="tab-content hidden p-4">
                <h2 class="text-lg font-bold mb-4 text-gray-800">ğŸ“ˆ Ú¯Ø²Ø§Ø±Ø´ Ø³ÙˆØ¯ Ùˆ Ø²ÛŒØ§Ù†</h2>
                
                <div class="glass-effect p-4 rounded-xl mb-4">
                    <h3 class="text-md font-semibold mb-3 text-gray-800">Ø§Ù†ØªØ®Ø§Ø¨ Ø¯ÙˆØ±Ù‡</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">Ø§Ø² ØªØ§Ø±ÛŒØ®</label>
                            <input type="date" id="plFromDate" class="w-full p-3 border rounded-xl input-focus">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2 text-gray-700">ØªØ§ ØªØ§Ø±ÛŒØ®</label>
                            <input type="date" id="plToDate" class="w-full p-3 border rounded-xl input-focus">
                        </div>
                        <div class="flex items-end">
                            <button onclick="generateProfitLossReport()" class="w-full bg-gradient-to-r from-emerald-500 to-emerald-600 text-white py-3 rounded-xl btn-hover">
                                ØªÙˆÙ„ÛŒØ¯ Ú¯Ø²Ø§Ø±Ø´
                            </button>
                        </div>
                    </div>
                </div>

                <div id="profitLossDisplay" class="glass-effect p-4 rounded-xl">
                    <div class="text-center text-gray-500 py-8">
                        Ø¨Ø±Ø§ÛŒ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ú¯Ø²Ø§Ø±Ø´ Ø³ÙˆØ¯ Ùˆ Ø²ÛŒØ§Ù†ØŒ Ø¯ÙˆØ±Ù‡ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data Storage
        let productions = JSON.parse(localStorage.getItem('neginAlvand_productions')) || [];
        let halls = JSON.parse(localStorage.getItem('neginAlvand_halls')) || [];
        let purchases = JSON.parse(localStorage.getItem('neginAlvand_purchases')) || [];
        let sales = JSON.parse(localStorage.getItem('neginAlvand_sales')) || [];
        let expenses = JSON.parse(localStorage.getItem('neginAlvand_expenses')) || [];

        // PWA Variables
        let deferredPrompt;
        let isInstalled = false;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateCurrentDate();
            updateDashboard();
            loadProductions();
            loadHalls();
            loadPurchases();
            loadSales();
            loadExpenses();
            updateHallOptions();
            setupEventListeners();
            initializePWA();
            checkOnlineStatus();
        });

        // PWA Functions
        function initializePWA() {
            // Check if already installed
            if (window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone) {
                isInstalled = true;
                return;
            }

            // Listen for beforeinstallprompt event
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                showInstallPrompt();
            });

            // Check if dismissed before
            if (localStorage.getItem('installPromptDismissed') !== 'true') {
                setTimeout(showInstallPrompt, 3000);
            }
        }

        function showInstallPrompt() {
            if (!isInstalled && !localStorage.getItem('installPromptDismissed')) {
                document.getElementById('installPrompt').style.display = 'block';
            }
        }

        function installApp() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted the install prompt');
                        isInstalled = true;
                    }
                    deferredPrompt = null;
                    document.getElementById('installPrompt').style.display = 'none';
                });
            } else {
                // Fallback for browsers that don't support PWA install
                alert('Ø¨Ø±Ø§ÛŒ Ù†ØµØ¨ Ø¨Ø±Ù†Ø§Ù…Ù‡:\n\nğŸ“± Android Chrome: Ù…Ù†Ùˆ â† "Add to Home screen"\nğŸ iOS Safari: Share â† "Add to Home Screen"\nğŸ’» Desktop: Ø¢Ø¯Ø±Ø³ Ø¨Ø§Ø± â† Ø¢ÛŒÚ©ÙˆÙ† Ù†ØµØ¨');
                dismissInstall();
            }
        }

        function dismissInstall() {
            document.getElementById('installPrompt').style.display = 'none';
            localStorage.setItem('installPromptDismissed', 'true');
        }

        // Online/Offline Status
        function checkOnlineStatus() {
            function updateOnlineStatus() {
                const offlineIndicator = document.getElementById('offlineIndicator');
                if (navigator.onLine) {
                    offlineIndicator.style.display = 'none';
                } else {
                    offlineIndicator.style.display = 'block';
                }
            }

            window.addEventListener('online', updateOnlineStatus);
            window.addEventListener('offline', updateOnlineStatus);
            updateOnlineStatus();
        }

        function setupEventListeners() {
            // Auto calculate purchase total
            document.getElementById('purchaseQuantity')?.addEventListener('input', calculatePurchaseTotal);
            document.getElementById('purchaseUnitPrice')?.addEventListener('input', calculatePurchaseTotal);
            
            // Auto calculate sale total
            document.getElementById('saleWeight')?.addEventListener('input', calculateSaleTotal);
            document.getElementById('pricePerKg')?.addEventListener('input', calculateSaleTotal);
        }

        // Date Functions
        function updateCurrentDate() {
            const today = new Date();
            const persianDate = today.toLocaleDateString('fa-IR');
            document.getElementById('currentDate').textContent = persianDate;
        }

        // Tab Functions
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(tabName).classList.remove('hidden');
            event.target.classList.add('active');
        }

        // Production Functions
        function showAddProduction() {
            document.getElementById('addProductionForm').classList.remove('hidden');
            document.getElementById('harvestDate').value = new Date().toISOString().split('T')[0];
        }

        function hideAddProduction() {
            document.getElementById('addProductionForm').classList.add('hidden');
            clearProductionForm();
        }

        function clearProductionForm() {
            document.getElementById('productionHall').value = '';
            document.getElementById('harvestWeight').value = '';
            document.getElementById('productQuality').value = 'A';
            document.getElementById('harvestDate').value = '';
            document.getElementById('compostUsed').value = '';
            document.getElementById('mushroomCount').value = '';
            document.getElementById('hallTemp').value = '';
            document.getElementById('hallHumidity').value = '';
            document.getElementById('productionNotes').value = '';
        }

        function addProduction() {
            const hall = document.getElementById('productionHall').value;
            const weight = parseFloat(document.getElementById('harvestWeight').value);
            const quality = document.getElementById('productQuality').value;
            const date = document.getElementById('harvestDate').value;
            const compost = parseFloat(document.getElementById('compostUsed').value) || 0;
            const count = parseInt(document.getElementById('mushroomCount').value) || 0;
            const temp = parseFloat(document.getElementById('hallTemp').value) || 0;
            const humidity = parseFloat(document.getElementById('hallHumidity').value) || 0;
            const notes = document.getElementById('productionNotes').value;

            if (!hall || !weight || !date) {
                alert('Ù„Ø·ÙØ§Ù‹ Ø³Ø§Ù„Ù†ØŒ ÙˆØ²Ù† Ùˆ ØªØ§Ø±ÛŒØ® Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                return;
            }

            const efficiency = compost > 0 ? ((weight / compost) * 100).toFixed(1) : 0;

            const production = {
                id: Date.now(),
                hall,
                weight,
                quality,
                date,
                compost,
                count,
                temp,
                humidity,
                efficiency,
                notes
            };

            productions.push(production);
            localStorage.setItem('neginAlvand_productions', JSON.stringify(productions));
            
            loadProductions();
            updateDashboard();
            hideAddProduction();
            
            alert('ØªÙˆÙ„ÛŒØ¯ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯');
        }

        function loadProductions() {
            const tbody = document.getElementById('productionList');
            
            if (productions.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" class="p-8 text-center text-gray-500">Ù‡ÛŒÚ† ØªÙˆÙ„ÛŒØ¯ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª</td></tr>';
                return;
            }

            tbody.innerHTML = productions.map(production => `
                <tr class="border-b hover:bg-gray-50">
                    <td class="p-3 text-sm">${new Date(production.date).toLocaleDateString('fa-IR')}</td>
                    <td class="p-3 font-semibold text-sm">${production.hall}</td>
                    <td class="p-3 text-sm">${production.weight} Ú©ÛŒÙ„Ùˆ</td>
                    <td class="p-3 text-sm mobile-hide">
                        <span class="px-2 py-1 rounded text-xs ${getQualityColor(production.quality)}">
                            ${production.quality}
                        </span>
                    </td>
                    <td class="p-3 text-sm mobile-hide">${production.compost} Ú©ÛŒÙ„Ùˆ</td>
                    <td class="p-3 text-sm font-bold ${production.efficiency >= 20 ? 'text-green-600' : production.efficiency >= 15 ? 'text-orange-600' : 'text-red-600'}">${production.efficiency}%</td>
                    <td class="p-3">
                        <button onclick="deleteProduction(${production.id})" class="text-red-600 hover:text-red-800 text-sm">
                            ğŸ—‘ï¸
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function deleteProduction(id) {
            if (confirm('Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù Ø§ÛŒÙ† ØªÙˆÙ„ÛŒØ¯ Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø¯Ø§Ø±ÛŒØ¯ØŸ')) {
                productions = productions.filter(p => p.id !== id);
                localStorage.setItem('neginAlvand_productions', JSON.stringify(productions));
                loadProductions();
                updateDashboard();
            }
        }

        // Hall Functions
        function showAddHall() {
            document.getElementById('addHallForm').classList.remove('hidden');
        }

        function hideAddHall() {
            document.getElementById('addHallForm').classList.add('hidden');
            clearHallForm();
        }

        function clearHallForm() {
            document.getElementById('hallNumber').value = '';
            document.getElementById('hallName').value = '';
            document.getElementById('hallArea').value = '';
            document.getElementById('hallCapacity').value = '';
            document.getElementById('hallStartDate').value = '';
            document.getElementById('hallStatus').value = 'active';
        }

        function addHall() {
            const number = document.getElementById('hallNumber').value;
            const name = document.getElementById('hallName').value;
            const area = parseFloat(document.getElementById('hallArea').value);
            const capacity = parseFloat(document.getElementById('hallCapacity').value);
            const startDate = document.getElementById('hallStartDate').value;
            const status = document.getElementById('hallStatus').value;

            if (!number || !name || !area) {
                alert('Ù„Ø·ÙØ§Ù‹ Ø´Ù…Ø§Ø±Ù‡ØŒ Ù†Ø§Ù… Ø³Ø§Ù„Ù† Ùˆ Ù…Ø³Ø§Ø­Øª Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                return;
            }

            const hall = {
                id: Date.now(),
                number,
                name,
                area,
                capacity,
                startDate,
                status,
                displayName: `${number} - ${name}`
            };

            halls.push(hall);
            localStorage.setItem('neginAlvand_halls', JSON.stringify(halls));
            
            loadHalls();
            updateHallOptions();
            updateDashboard();
            hideAddHall();
            
            alert('Ø³Ø§Ù„Ù† Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯');
        }

        function loadHalls() {
            const container = document.getElementById('hallsList');
            
            if (halls.length === 0) {
                container.innerHTML = '<div class="glass-effect p-4 rounded-xl text-center"><p class="text-gray-500">Ù‡ÛŒÚ† Ø³Ø§Ù„Ù†ÛŒ ØªØ¹Ø±ÛŒÙ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª</p></div>';
                return;
            }

            container.innerHTML = halls.map(hall => `
                <div class="glass-effect p-4 rounded-xl card-shadow">
                    <div class="flex justify-between items-start mb-3">
                        <h3 class="font-semibold text-md">${hall.displayName}</h3>
                        <span class="text-xs px-2 py-1 rounded-full text-white ${getHallStatusClass(hall.status)}">
                            ${getStatusText(hall.status)}
                        </span>
                    </div>
                    <div class="space-y-2 text-sm text-gray-600">
                        <p>ğŸ“ Ù…Ø³Ø§Ø­Øª: ${hall.area} Ù…ØªØ± Ù…Ø±Ø¨Ø¹</p>
                        <p>ğŸ“Š Ø¸Ø±ÙÛŒØª: ${hall.capacity || 0} Ú©ÛŒÙ„Ùˆ/Ù…Ø§Ù‡</p>
                        <p>ğŸ“… Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ: ${hall.startDate ? new Date(hall.startDate).toLocaleDateString('fa-IR') : '-'}</p>
                    </div>
                    <div class="mt-3 flex space-x-2 space-x-reverse">
                        <button onclick="deleteHall(${hall.id})" class="text-red-600 hover:text-red-800 text-sm">
                            Ø­Ø°Ù
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function deleteHall(id) {
            if (confirm('Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù Ø§ÛŒÙ† Ø³Ø§Ù„Ù† Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø¯Ø§Ø±ÛŒØ¯ØŸ')) {
                halls = halls.filter(h => h.id !== id);
                localStorage.setItem('neginAlvand_halls', JSON.stringify(halls));
                loadHalls();
                updateHallOptions();
                updateDashboard();
            }
        }

        function updateHallOptions() {
            const selects = ['productionHall', 'reportHall'];
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                if (select) {
                    const currentValue = select.value;
                    select.innerHTML = '<option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ø³Ø§Ù„Ù†</option>' + 
                        halls.filter(h => h.status === 'active')
                             .map(h => `<option value="${h.displayName}">${h.displayName}</option>`)
                             .join('');
                    select.value = currentValue;
                }
            });
        }

        // Purchase Functions
        function showAddPurchase() {
            document.getElementById('addPurchaseForm').classList.remove('hidden');
            document.getElementById('purchaseDate').value = new Date().toISOString().split('T')[0];
        }

        function hideAddPurchase() {
            document.getElementById('addPurchaseForm').classList.add('hidden');
            clearPurchaseForm();
        }

        function clearPurchaseForm() {
            document.getElementById('purchaseItem').value = '';
            document.getElementById('supplierName').value = '';
            document.getElementById('purchaseDate').value = '';
            document.getElementById('purchaseQuantity').value = '';
            document.getElementById('purchaseUnit').value = 'kg';
            document.getElementById('purchaseUnitPrice').value = '';
            document.getElementById('purchaseTotalAmount').value = '';
            document.getElementById('purchasePaymentType').value = 'cash';
            document.getElementById('purchaseNotes').value = '';
        }

        function calculatePurchaseTotal() {
            const quantity = parseFloat(document.getElementById('purchaseQuantity').value) || 0;
            const unitPrice = parseFloat(document.getElementById('purchaseUnitPrice').value) || 0;
            const total = quantity * unitPrice;
            document.getElementById('purchaseTotalAmount').value = total;
        }

        function addPurchase() {
            const item = document.getElementById('purchaseItem').value;
            const supplier = document.getElementById('supplierName').value;
            const date = document.getElementById('purchaseDate').value;
            const quantity = parseFloat(document.getElementById('purchaseQuantity').value);
            const unit = document.getElementById('purchaseUnit').value;
            const unitPrice = parseFloat(document.getElementById('purchaseUnitPrice').value);
            const totalAmount = parseFloat(document.getElementById('purchaseTotalAmount').value);
            const paymentType = document.getElementById('purchasePaymentType').value;
            const notes = document.getElementById('purchaseNotes').value;

            if (!item || !supplier || !quantity || !unitPrice || !date) {
                alert('Ù„Ø·ÙØ§Ù‹ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¶Ø±ÙˆØ±ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                return;
            }

            const purchase = {
                id: Date.now(),
                item,
                supplier,
                date,
                quantity,
                unit,
                unitPrice,
                totalAmount,
                paymentType,
                notes
            };

            purchases.push(purchase);
            localStorage.setItem('neginAlvand_purchases', JSON.stringify(purchases));
            
            loadPurchases();
            updateDashboard();
            hideAddPurchase();
            
            alert('Ø®Ø±ÛŒØ¯ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯');
        }

        function loadPurchases() {
            const tbody = document.getElementById('purchasesList');
            
            if (purchases.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" class="p-8 text-center text-gray-500">Ù‡ÛŒÚ† Ø®Ø±ÛŒØ¯ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª</td></tr>';
                return;
            }

            tbody.innerHTML = purchases.map(purchase => `
                <tr class="border-b hover:bg-gray-50">
                    <td class="p-3 text-sm">${new Date(purchase.date).toLocaleDateString('fa-IR')}</td>
                    <td class="p-3 font-semibold text-sm">${purchase.item}</td>
                    <td class="p-3 text-sm">${purchase.supplier}</td>
                    <td class="p-3 text-sm">${purchase.quantity} ${getUnitText(purchase.unit)}</td>
                    <td class="p-3 text-sm">${purchase.unitPrice.toLocaleString()} ØªÙˆÙ…Ø§Ù†</td>
                    <td class="p-3 font-bold text-blue-600 text-sm">${purchase.totalAmount.toLocaleString()} ØªÙˆÙ…Ø§Ù†</td>
                    <td class="p-3">
                        <button onclick="deletePurchase(${purchase.id})" class="text-red-600 hover:text-red-800 text-sm">
                            Ø­Ø°Ù
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function deletePurchase(id) {
            if (confirm('Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù Ø§ÛŒÙ† Ø®Ø±ÛŒØ¯ Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø¯Ø§Ø±ÛŒØ¯ØŸ')) {
                purchases = purchases.filter(p => p.id !== id);
                localStorage.setItem('neginAlvand_purchases', JSON.stringify(purchases));
                loadPurchases();
                updateDashboard();
            }
        }

        // Sales Functions
        function showAddSale() {
            document.getElementById('addSaleForm').classList.remove('hidden');
            document.getElementById('saleDate').value = new Date().toISOString().split('T')[0];
        }

        function hideAddSale() {
            document.getElementById('addSaleForm').classList.add('hidden');
            clearSaleForm();
        }

        function clearSaleForm() {
            document.getElementById('customerName').value = '';
            document.getElementById('customerPhone').value = '';
            document.getElementById('customerType').value = 'retail';
            document.getElementById('saleWeight').value = '';
            document.getElementById('saleQuality').value = 'A';
            document.getElementById('pricePerKg').value = '';
            document.getElementById('saleTotalAmount').value = '';
            document.getElementById('salePaymentType').value = 'cash';
            document.getElementById('costPrice').value = '';
            document.getElementById('saleDate').value = '';
            document.getElementById('saleNotes').value = '';
        }

        function calculateSaleTotal() {
            const weight = parseFloat(document.getElementById('saleWeight').value) || 0;
            const price = parseFloat(document.getElementById('pricePerKg').value) || 0;
            const total = weight * price;
            document.getElementById('saleTotalAmount').value = total;
        }

        function addSale() {
            const customerName = document.getElementById('customerName').value;
            const customerPhone = document.getElementById('customerPhone').value;
            const customerType = document.getElementById('customerType').value;
            const weight = parseFloat(document.getElementById('saleWeight').value);
            const quality = document.getElementById('saleQuality').value;
            const pricePerKg = parseFloat(document.getElementById('pricePerKg').value);
            const totalAmount = parseFloat(document.getElementById('saleTotalAmount').value);
            const paymentType = document.getElementById('salePaymentType').value;
            const costPrice = parseFloat(document.getElementById('costPrice').value) || 0;
            const date = document.getElementById('saleDate').value;
            const notes = document.getElementById('saleNotes').value;

            if (!customerName || !weight || !pricePerKg || !date) {
                alert('Ù„Ø·ÙØ§Ù‹ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¶Ø±ÙˆØ±ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                return;
            }

            const profit = (pricePerKg - costPrice) * weight;

            const sale = {
                id: Date.now(),
                customerName,
                customerPhone,
                customerType,
                weight,
                quality,
                pricePerKg,
                totalAmount,
                paymentType,
                costPrice,
                profit,
                date,
                notes
            };

            sales.push(sale);
            localStorage.setItem('neginAlvand_sales', JSON.stringify(sales));
            
            loadSales();
            updateDashboard();
            hideAddSale();
            
            alert('ÙØ±ÙˆØ´ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯');
        }

        function loadSales() {
            const tbody = document.getElementById('salesList');
            
            if (sales.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" class="p-8 text-center text-gray-500">Ù‡ÛŒÚ† ÙØ±ÙˆØ´ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª</td></tr>';
                return;
            }

            tbody.innerHTML = sales.map(sale => `
                <tr class="border-b hover:bg-gray-50">
                    <td class="p-3 text-sm">${new Date(sale.date).toLocaleDateString('fa-IR')}</td>
                    <td class="p-3 font-semibold text-sm">${sale.customerName}</td>
                    <td class="p-3 text-sm">${sale.weight} Ú©ÛŒÙ„Ùˆ</td>
                    <td class="p-3 text-sm">${sale.pricePerKg.toLocaleString()} ØªÙˆÙ…Ø§Ù†</td>
                    <td class="p-3 font-bold text-green-600 text-sm">${sale.totalAmount.toLocaleString()} ØªÙˆÙ…Ø§Ù†</td>
                    <td class="p-3 font-bold text-sm ${sale.profit >= 0 ? 'text-emerald-600' : 'text-red-600'}">${sale.profit.toLocaleString()} ØªÙˆÙ…Ø§Ù†</td>
                    <td class="p-3">
                        <button onclick="deleteSale(${sale.id})" class="text-red-600 hover:text-red-800 text-sm">
                            Ø­Ø°Ù
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function deleteSale(id) {
            if (confirm('Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù Ø§ÛŒÙ† ÙØ±ÙˆØ´ Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø¯Ø§Ø±ÛŒØ¯ØŸ')) {
                sales = sales.filter(s => s.id !== id);
                localStorage.setItem('neginAlvand_sales', JSON.stringify(sales));
                loadSales();
                updateDashboard();
            }
        }

        // Expense Functions
        function showAddExpense() {
            document.getElementById('addExpenseForm').classList.remove('hidden');
            document.getElementById('expenseDate').value = new Date().toISOString().split('T')[0];
        }

        function hideAddExpense() {
            document.getElementById('addExpenseForm').classList.add('hidden');
            clearExpenseForm();
        }

        function clearExpenseForm() {
            document.getElementById('expenseCategory').value = 'materials';
            document.getElementById('expenseAmount').value = '';
            document.getElementById('expenseDate').value = '';
            document.getElementById('paidTo').value = '';
            document.getElementById('expensePaymentType').value = 'cash';
            document.getElementById('expenseDocNumber').value = '';
            document.getElementById('expenseDescription').value = '';
        }

        function addExpense() {
            const category = document.getElementById('expenseCategory').value;
            const amount = parseFloat(document.getElementById('expenseAmount').value);
            const date = document.getElementById('expenseDate').value;
            const paidTo = document.getElementById('paidTo').value;
            const paymentType = document.getElementById('expensePaymentType').value;
            const docNumber = document.getElementById('expenseDocNumber').value;
            const description = document.getElementById('expenseDescription').value;

            if (!amount || !date) {
                alert('Ù„Ø·ÙØ§Ù‹ Ù…Ø¨Ù„Øº Ùˆ ØªØ§Ø±ÛŒØ® Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                return;
            }

            const expense = {
                id: Date.now(),
                category,
                amount,
                date,
                paidTo,
                paymentType,
                docNumber,
                description
            };

            expenses.push(expense);
            localStorage.setItem('neginAlvand_expenses', JSON.stringify(expenses));
            
            loadExpenses();
            updateDashboard();
            hideAddExpense();
            
            alert('Ù‡Ø²ÛŒÙ†Ù‡ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ø´Ø¯');
        }

        function loadExpenses() {
            const tbody = document.getElementById('expensesList');
            
            if (expenses.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" class="p-8 text-center text-gray-500">Ù‡ÛŒÚ† Ù‡Ø²ÛŒÙ†Ù‡â€ŒØ§ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª</td></tr>';
                return;
            }

            tbody.innerHTML = expenses.map(expense => `
                <tr class="border-b hover:bg-gray-50">
                    <td class="p-3 text-sm">${new Date(expense.date).toLocaleDateString('fa-IR')}</td>
                    <td class="p-3 text-sm">${getExpenseCategoryText(expense.category)}</td>
                    <td class="p-3 font-bold text-red-600 text-sm">${expense.amount.toLocaleString()} ØªÙˆÙ…Ø§Ù†</td>
                    <td class="p-3 text-sm">${expense.paidTo || '-'}</td>
                    <td class="p-3 text-sm">${getPaymentTypeText(expense.paymentType)}</td>
                    <td class="p-3">
                        <button onclick="deleteExpense(${expense.id})" class="text-red-600 hover:text-red-800 text-sm">
                            Ø­Ø°Ù
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function deleteExpense(id) {
            if (confirm('Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù Ø§ÛŒÙ† Ù‡Ø²ÛŒÙ†Ù‡ Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø¯Ø§Ø±ÛŒØ¯ØŸ')) {
                expenses = expenses.filter(e => e.id !== id);
                localStorage.setItem('neginAlvand_expenses', JSON.stringify(expenses));
                loadExpenses();
                updateDashboard();
            }
        }

        // Dashboard Functions
        function updateDashboard() {
            const today = new Date().toISOString().split('T')[0];
            const thisMonth = getThisMonthDates();
            
            // Today's production
            const todayProduction = productions
                .filter(p => p.date === today)
                .reduce((sum, p) => sum + p.weight, 0);
            
            // Monthly revenue
            const monthlyRevenue = sales
                .filter(s => thisMonth.includes(s.date))
                .reduce((sum, s) => sum + s.totalAmount, 0);
            
            // Active halls
            const activeHalls = halls.filter(h => h.status === 'active').length;
            
            // Net profit
            const totalRevenue = sales.reduce((sum, s) => sum + s.totalAmount, 0);
            const totalExpenses = expenses.reduce((sum, e) => sum + e.amount, 0);
            const totalPurchases = purchases.reduce((sum, p) => sum + p.totalAmount, 0);
            const netProfit = totalRevenue - totalExpenses - totalPurchases;

            document.getElementById('todayProduction').textContent = todayProduction.toFixed(1) + ' Ú©ÛŒÙ„Ùˆ';
            document.getElementById('monthlyRevenue').textContent = monthlyRevenue.toLocaleString() + ' ØªÙˆÙ…Ø§Ù†';
            document.getElementById('activeHalls').textContent = activeHalls;
            document.getElementById('netProfit').textContent = netProfit.toLocaleString() + ' ØªÙˆÙ…Ø§Ù†';
        }

        // Report Functions
        function generateProductionReport() {
            const fromDate = document.getElementById('reportFromDate').value;
            const toDate = document.getElementById('reportToDate').value;
            const hall = document.getElementById('reportHall').value;
            
            let filteredProductions = productions;
            
            if (fromDate) {
                filteredProductions = filteredProductions.filter(p => p.date >= fromDate);
            }
            if (toDate) {
                filteredProductions = filteredProductions.filter(p => p.date <= toDate);
            }
            if (hall) {
                filteredProductions = filteredProductions.filter(p => p.hall === hall);
            }
            
            const reportDisplay = document.getElementById('reportDisplay');
            const reportTitle = document.getElementById('reportTitle');
            const reportContent = document.getElementById('reportContent');
            
            reportTitle.textContent = 'ğŸ„ Ú¯Ø²Ø§Ø±Ø´ ØªÙˆÙ„ÛŒØ¯';
            
            const totalProduction = filteredProductions.reduce((sum, p) => sum + p.weight, 0);
            const totalCompost = filteredProductions.reduce((sum, p) => sum + p.compost, 0);
            const avgEfficiency = totalCompost > 0 ? ((totalProduction / totalCompost) * 100).toFixed(1) : 0;
            
            reportContent.innerHTML = `
                <div class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-emerald-100 p-4 rounded-xl text-center">
                            <h4 class="font-semibold text-emerald-800">Ú©Ù„ ØªÙˆÙ„ÛŒØ¯</h4>
                            <p class="text-xl font-bold text-emerald-600">${totalProduction.toFixed(1)} Ú©ÛŒÙ„Ùˆ</p>
                        </div>
                        <div class="bg-blue-100 p-4 rounded-xl text-center">
                            <h4 class="font-semibold text-blue-800">Ú©Ù„ Ú©Ù…Ù¾ÙˆØ³Øª</h4>
                            <p class="text-xl font-bold text-blue-600">${totalCompost.toFixed(1)} Ú©ÛŒÙ„Ùˆ</p>
                        </div>
                        <div class="bg-purple-100 p-4 rounded-xl text-center">
                            <h4 class="font-semibold text-purple-800">Ø±Ø§Ù†Ø¯Ù…Ø§Ù† Ù…ØªÙˆØ³Ø·</h4>
                            <p class="text-xl font-bold text-purple-600">${avgEfficiency}%</p>
                        </div>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full border">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="p-3 text-right">ØªØ§Ø±ÛŒØ®</th>
                                    <th class="p-3 text-right">Ø³Ø§Ù„Ù†</th>
                                    <th class="p-3 text-right">ØªÙˆÙ„ÛŒØ¯ (Ú©ÛŒÙ„Ùˆ)</th>
                                    <th class="p-3 text-right">Ú©Ù…Ù¾ÙˆØ³Øª (Ú©ÛŒÙ„Ùˆ)</th>
                                    <th class="p-3 text-right">Ø±Ø§Ù†Ø¯Ù…Ø§Ù† (%)</th>
                                    <th class="p-3 text-right">Ú©ÛŒÙÛŒØª</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${filteredProductions.map(p => `
                                    <tr class="border-b">
                                        <td class="p-3">${new Date(p.date).toLocaleDateString('fa-IR')}</td>
                                        <td class="p-3">${p.hall}</td>
                                        <td class="p-3">${p.weight}</td>
                                        <td class="p-3">${p.compost}</td>
                                        <td class="p-3">${p.efficiency}%</td>
                                        <td class="p-3">${p.quality}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
            
            reportDisplay.classList.remove('hidden');
        }

        function generateEfficiencyReport() {
            const reportDisplay = document.getElementById('reportDisplay');
            const reportTitle = document.getElementById('reportTitle');
            const reportContent = document.getElementById('reportContent');
            
            reportTitle.textContent = 'ğŸ“ˆ Ú¯Ø²Ø§Ø±Ø´ Ø±Ø§Ù†Ø¯Ù…Ø§Ù† Ø³Ø§Ù„Ù†â€ŒÙ‡Ø§';
            
            const hallEfficiency = halls.map(hall => {
                const hallProductions = productions.filter(p => p.hall === hall.displayName);
                const totalProduction = hallProductions.reduce((sum, p) => sum + p.weight, 0);
                const totalCompost = hallProductions.reduce((sum, p) => sum + p.compost, 0);
                const efficiency = totalCompost > 0 ? ((totalProduction / totalCompost) * 100).toFixed(1) : 0;
                
                return {
                    hall: hall.displayName,
                    totalProduction,
                    totalCompost,
                    efficiency,
                    harvestCount: hallProductions.length
                };
            });
            
            reportContent.innerHTML = `
                <div class="space-y-4">
                    <div class="overflow-x-auto">
                        <table class="w-full border">
                            <thead class="bg-gray-100">
                                <tr>
                                    <th class="p-3 text-right">Ø³Ø§Ù„Ù†</th>
                                    <th class="p-3 text-right">ØªØ¹Ø¯Ø§Ø¯ Ø¨Ø±Ø¯Ø§Ø´Øª</th>
                                    <th class="p-3 text-right">Ú©Ù„ ØªÙˆÙ„ÛŒØ¯ (Ú©ÛŒÙ„Ùˆ)</th>
                                    <th class="p-3 text-right">Ú©Ù„ Ú©Ù…Ù¾ÙˆØ³Øª (Ú©ÛŒÙ„Ùˆ)</th>
                                    <th class="p-3 text-right">Ø±Ø§Ù†Ø¯Ù…Ø§Ù† (%)</th>
                                    <th class="p-3 text-right">ÙˆØ¶Ø¹ÛŒØª</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${hallEfficiency.map(h => `
                                    <tr class="border-b">
                                        <td class="p-3 font-semibold">${h.hall}</td>
                                        <td class="p-3">${h.harvestCount}</td>
                                        <td class="p-3">${h.totalProduction.toFixed(1)}</td>
                                        <td class="p-3">${h.totalCompost.toFixed(1)}</td>
                                        <td class="p-3 font-bold ${h.efficiency >= 20 ? 'text-green-600' : h.efficiency >= 15 ? 'text-orange-600' : 'text-red-600'}">${h.efficiency}%</td>
                                        <td class="p-3">
                                            <span class="px-2 py-1 rounded text-xs ${h.efficiency >= 20 ? 'bg-green-100 text-green-800' : h.efficiency >= 15 ? 'bg-orange-100 text-orange-800' : 'bg-red-100 text-red-800'}">
                                                ${h.efficiency >= 20 ? 'Ø¹Ø§Ù„ÛŒ' : h.efficiency >= 15 ? 'Ø®ÙˆØ¨' : 'Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø¨Ù‡Ø¨ÙˆØ¯'}
                                            </span>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
            
            reportDisplay.classList.remove('hidden');
        }

        function generateProfitLossReport() {
            const fromDate = document.getElementById('plFromDate').value;
            const toDate = document.getElementById('plToDate').value;
            
            if (!fromDate || !toDate) {
                alert('Ù„Ø·ÙØ§Ù‹ Ø¯ÙˆØ±Ù‡ Ø²Ù…Ø§Ù†ÛŒ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯');
                return;
            }
            
            const filteredSales = sales.filter(s => s.date >= fromDate && s.date <= toDate);
            const filteredExpenses = expenses.filter(e => e.date >= fromDate && e.date <= toDate);
            const filteredPurchases = purchases.filter(p => p.date >= fromDate && p.date <= toDate);
            
            const totalRevenue = filteredSales.reduce((sum, s) => sum + s.totalAmount, 0);
            const totalExpenses = filteredExpenses.reduce((sum, e) => sum + e.amount, 0);
            const totalPurchases = filteredPurchases.reduce((sum, p) => sum + p.totalAmount, 0);
            const grossProfit = filteredSales.reduce((sum, s) => sum + s.profit, 0);
            const netProfit = totalRevenue - totalExpenses - totalPurchases;
            
            const profitLossDisplay = document.getElementById('profitLossDisplay');
            
            profitLossDisplay.innerHTML = `
                <div class="space-y-6">
                    <div class="text-center mb-6">
                        <h3 class="text-lg font-bold text-gray-800">Ú¯Ø²Ø§Ø±Ø´ Ø³ÙˆØ¯ Ùˆ Ø²ÛŒØ§Ù†</h3>
                        <p class="text-sm text-gray-600">Ø§Ø² ${new Date(fromDate).toLocaleDateString('fa-IR')} ØªØ§ ${new Date(toDate).toLocaleDateString('fa-IR')}</p>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-green-50 p-4 rounded-xl">
                            <h4 class="font-semibold text-green-800 mb-3">Ø¯Ø±Ø¢Ù…Ø¯Ù‡Ø§</h4>
                            <div class="space-y-2">
                                <div class="flex justify-between">
                                    <span>ÙØ±ÙˆØ´ Ù…Ø­ØµÙˆÙ„Ø§Øª:</span>
                                    <span class="font-bold text-green-600">${totalRevenue.toLocaleString()} ØªÙˆÙ…Ø§Ù†</span>
                                </div>
                                <div class="border-t pt-2">
                                    <div class="flex justify-between font-bold">
                                        <span>Ú©Ù„ Ø¯Ø±Ø¢Ù…Ø¯:</span>
                                        <span class="text-green-600">${totalRevenue.toLocaleString()} ØªÙˆÙ…Ø§Ù†</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-red-50 p-4 rounded-xl">
                            <h4 class="font-semibold text-red-800 mb-3">Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§</h4>
                            <div class="space-y-2">
                                <div class="flex justify-between">
                                    <span>Ø®Ø±ÛŒØ¯ Ù…ÙˆØ§Ø¯ Ø§ÙˆÙ„ÛŒÙ‡:</span>
                                    <span class="font-bold text-red-600">${totalPurchases.toLocaleString()} ØªÙˆÙ…Ø§Ù†</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Ø³Ø§ÛŒØ± Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§:</span>
                                    <span class="font-bold text-red-600">${totalExpenses.toLocaleString()} ØªÙˆÙ…Ø§Ù†</span>
                                </div>
                                <div class="border-t pt-2">
                                    <div class="flex justify-between font-bold">
                                        <span>Ú©Ù„ Ù‡Ø²ÛŒÙ†Ù‡:</span>
                                        <span class="text-red-600">${(totalPurchases + totalExpenses).toLocaleString()} ØªÙˆÙ…Ø§Ù†</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-blue-50 p-6 rounded-xl text-center">
                        <h4 class="font-semibold text-blue-800 mb-4">Ø®Ù„Ø§ØµÙ‡ Ù†ØªØ§ÛŒØ¬</h4>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <p class="text-sm text-gray-600">Ø³ÙˆØ¯ Ù†Ø§Ø®Ø§Ù„Øµ</p>
                                <p class="text-xl font-bold ${grossProfit >= 0 ? 'text-green-600' : 'text-red-600'}">${grossProfit.toLocaleString()} ØªÙˆÙ…Ø§Ù†</p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-600">Ø³ÙˆØ¯ Ø®Ø§Ù„Øµ</p>
                                <p class="text-2xl font-bold ${netProfit >= 0 ? 'text-green-600' : 'text-red-600'}">${netProfit.toLocaleString()} ØªÙˆÙ…Ø§Ù†</p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-600">Ø­Ø§Ø´ÛŒÙ‡ Ø³ÙˆØ¯</p>
                                <p class="text-xl font-bold ${netProfit >= 0 ? 'text-green-600' : 'text-red-600'}">${totalRevenue > 0 ? ((netProfit / totalRevenue) * 100).toFixed(1) : 0}%</p>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function printReport() {
            window.print();
        }

        function exportReport() {
            alert('Ù‚Ø§Ø¨Ù„ÛŒØª Ø®Ø±ÙˆØ¬ÛŒ Ú¯Ø²Ø§Ø±Ø´ Ø¯Ø± Ù†Ø³Ø®Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯');
        }

        // Utility Functions
        function getThisMonthDates() {
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth();
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            
            const dates = [];
            for (let d = new Date(firstDay); d <= lastDay; d.setDate(d.getDate() + 1)) {
                dates.push(d.toISOString().split('T')[0]);
            }
            return dates;
        }

        function getQualityColor(quality) {
            const colors = {
                'A': 'bg-green-100 text-green-800',
                'B': 'bg-blue-100 text-blue-800',
                'C': 'bg-orange-100 text-orange-800',
                'D': 'bg-red-100 text-red-800'
            };
            return colors[quality] || 'bg-gray-100 text-gray-800';
        }

        function getHallStatusClass(status) {
            const classes = {
                'active': 'status-active',
                'maintenance': 'status-maintenance',
                'inactive': 'status-inactive'
            };
            return classes[status] || 'bg-gray-500';
        }

        function getStatusText(status) {
            const texts = {
                'active': 'ÙØ¹Ø§Ù„',
                'maintenance': 'ØªØ¹Ù…ÛŒØ±Ø§Øª',
                'inactive': 'ØºÛŒØ±ÙØ¹Ø§Ù„'
            };
            return texts[status] || status;
        }

        function getUnitText(unit) {
            const units = {
                'kg': 'Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…',
                'ton': 'ØªÙ†',
                'liter': 'Ù„ÛŒØªØ±',
                'piece': 'Ø¹Ø¯Ø¯',
                'bag': 'Ú©ÛŒØ³Ù‡'
            };
            return units[unit] || unit;
        }

        function getExpenseCategoryText(category) {
            const categories = {
                'materials': 'Ù…ÙˆØ§Ø¯ Ø§ÙˆÙ„ÛŒÙ‡',
                'labor': 'Ù†ÛŒØ±ÙˆÛŒ Ú©Ø§Ø±',
                'energy': 'Ø§Ù†Ø±Ú˜ÛŒ',
                'maintenance': 'ØªØ¹Ù…ÛŒØ± Ùˆ Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ',
                'transport': 'Ø­Ù…Ù„ Ùˆ Ù†Ù‚Ù„',
                'packaging': 'Ø¨Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ',
                'insurance': 'Ø¨ÛŒÙ…Ù‡',
                'rent': 'Ø§Ø¬Ø§Ø±Ù‡',
                'other': 'Ø³Ø§ÛŒØ±'
            };
            return categories[category] || category;
        }

        function getPaymentTypeText(type) {
            const types = {
                'cash': 'Ù†Ù‚Ø¯ÛŒ',
                'credit': 'Ø§Ø¹ØªØ¨Ø§Ø±ÛŒ',
                'check': 'Ú†Ú©',
                'transfer': 'Ø­ÙˆØ§Ù„Ù‡',
                'card': 'Ú©Ø§Ø±Øª'
            };
            return types[type] || type;
        }

        // Additional report functions would be implemented similarly...
        function generateSalesReport() { /* Implementation */ }
        function generatePurchaseReport() { /* Implementation */ }
        function generateExpenseReport() { /* Implementation */ }
        function generatePartyReport() { /* Implementation */ }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9698bc9160b5ea1e',t:'MTc1NDI1NDc0My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
